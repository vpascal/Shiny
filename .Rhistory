trim <- function (x) gsub("^\\s+|\\s+$+|\\?", "", x)
replace<-function (x) gsub("unic", "unique", x)
data<-as.data.frame(apply(data,MARGIN=2,FUN=trim))
data<-as.data.frame(apply(data,MARGIN=2,FUN=replace))
data<-data[which(data$Question !="Upload other documents" & data$Question !="Upload photos"),]
data<-data[which(data$Name !="Biblioteca Publica de Drept" & data$Name !="Biblioteca Nationala a Republicii Moldova"),]
data<-data[data$Raion != "Chisinau",]
pattern<-agrep("Total number of registered/unic users of each gender",x=data$Question,useBytes=T)
gender<-data[pattern,]
gender$Answer<-as.numeric(gender$Answer)
gender<-gender%>% group_by(Date,Question) %>% summarise(Answer = sum(Answer,na.rm = TRUE))
gender<-cast(gender, Date~Question)
gender$Total<-gender[,2]+gender[,3]
gender$Percent_Female<-gender[,2]/gender[,4]*100
gender$Percent_Male<-gender[,3]/gender[,4]*100
gender<-gender[,c("Date","Percent_Female","Percent_Male")]
gender<-as.data.frame(gender)
gender<-melt(gender,"Date")
gender$Date<-as.Date(format(as.Date(gender$Date),"%b,%y"))
gender$Date<-as.Date(gender$Date)
gender%>%
ggvis(x=~Date,y=~value,stroke= ~variable) %>%
layer_lines() %>%
layer_points(fill= ~variable)
View(gender)
shiny::runApp()
library(ggvis)
all_values <- function(x) {
if(is.null(x)) return(NULL)
paste0(names(x), ": ", format(x), collapse = "<br />")
}
gender%>%
ggvis(x=~Date,y=~Percent_Female) %>%
layer_lines() %>%
layer_points() %>%
add_tooltip(all_values, "hover")
area%>%
ggvis(x=~long,y=~lat, stroke := "white") %>%
group_by(group) %>%
layer_paths() %>%
layer_paths(fill=~Value) %>%
hide_axis("x")%>%
hide_axis("y") %>%
#layer_points() %>%
add_tooltip(all_values, "hover") %>%
set_options(width = 400, height = 500)
options(stringsAsFactors = FALSE)
data <- read.csv("report_2014-06-27.csv", sep="\t",header=TRUE)
trim <- function (x) gsub("^\\s+|\\s+$+|\\?", "", x)
replace<-function (x) gsub("unic", "unique", x)
data<-as.data.frame(apply(data,MARGIN=2,FUN=trim))
data<-as.data.frame(apply(data,MARGIN=2,FUN=replace))
data<-data[which(data$Question !="Upload other documents" & data$Question !="Upload photos"),]
data<-data[which(data$Name !="Biblioteca Publica de Drept" & data$Name !="Biblioteca Nationala a Republicii Moldova"),]
data<-data[data$Raion != "Chisinau",]
# users
data$Question[data$Question=="Number of all new unique users to library"]<-"Number of all unique users to library"
pattern <- grep("Number of all unique users to library", data$Question, useBytes = T)
users<-data[pattern,]
users$Answer<-as.numeric(users$Answer)
users<-users%>% group_by(Date) %>% summarise(Answer = sum(Answer,na.rm = TRUE))
users$Date<-as.Date(users$Date)
# Gender
pattern<-agrep("Total number of registered/unic users of each gender",x=data$Question,useBytes=T)
gender<-data[pattern,]
gender$Answer<-as.numeric(gender$Answer)
gender<-gender%>% group_by(Date,Question) %>% summarise(Answer = sum(Answer,na.rm = TRUE))
gender<-cast(gender, Date~Question)
gender$Total<-gender[,2]+gender[,3]
gender$Percent_Female<-gender[,2]/gender[,4]*100
gender$Percent_Male<-gender[,3]/gender[,4]*100
gender<-gender[,c("Date","Percent_Female","Percent_Male")]
gender<-as.data.frame(gender)
gender<-melt(gender,"Date")
gender$Date<-as.Date(gender$Date)
users%>%
ggvis(x=~Date,y=~Answer) %>%
layer_lines() %>%
layer_points() %>%
bind_shiny("u")
gender%>%
ggvis(x=~Date,y=~value,stroke= ~variable) %>%
layer_lines() %>%
layer_points(fill= ~variable) %>%
bind_shiny("g")
})
all_values <- function(x) {
if(is.null(x)) return(NULL)
paste0(names(x), ": ", format(x), collapse = "<br />")
}
gender%>%
ggvis(x=~Date,y=~Percent_Female) %>%
layer_lines() %>%
layer_points() %>%
add_tooltip(all_values, "hover")
area%>%
ggvis(x=~long,y=~lat, stroke := "white") %>%
group_by(group) %>%
layer_paths() %>%
layer_paths(fill=~Value) %>%
hide_axis("x")%>%
hide_axis("y") %>%
#layer_points() %>%
add_tooltip(all_values, "hover") %>%
set_options(width = 400, height = 500)
gender%>%
ggvis(x=~Date,y=~Percent_Female) %>%
layer_lines() %>%
layer_points() %>%
add_tooltip(all_values, "hover")
View(gender)
gender<-cast(gender, Date~Question)
gender$Total<-gender[,2]+gender[,3]
gender$Percent_Female<-gender[,2]/gender[,4]*100
gender$Percent_Male<-gender[,3]/gender[,4]*100
gender<-gender[,c("Date","Percent_Female","Percent_Male")]
gender<-as.data.frame(gender)
gender<-melt(gender,"Date")
gender$Date<-as.Date(gender$Date)
library(shiny)
library(dplyr)
library(ggvis)
library(reshape)
library(rgdal)
library(rgeos)
library(maptools)
gpclibPermit()
# Gender
pattern<-agrep("Total number of registered/unic users of each gender",x=data$Question,useBytes=T)
gender<-data[pattern,]
gender$Answer<-as.numeric(gender$Answer)
gender<-gender%>% group_by(Date,Question) %>% summarise(Answer = sum(Answer,na.rm = TRUE))
gender<-cast(gender, Date~Question)
gender$Total<-gender[,2]+gender[,3]
gender$Percent_Female<-gender[,2]/gender[,4]*100
gender$Percent_Male<-gender[,3]/gender[,4]*100
gender<-gender[,c("Date","Percent_Female","Percent_Male")]
gender<-as.data.frame(gender)
gender<-melt(gender,"Date")
gender$Date<-as.Date(gender$Date)
gender%>%
ggvis(x=~Date,y=~Percent_Female) %>%
layer_lines() %>%
layer_points() %>%
add_tooltip(all_values, "hover")
View(gender)
View(gender)
View(gender)
gender%>%
ggvis(x=~Date,y=~variable) %>%
layer_lines() %>%
layer_points() %>%
add_tooltip(all_values, "hover")
gender%>%
ggvis(x=~Date,y=~value,stroke= ~variable) %>%
layer_lines() %>%
layer_points() %>%
add_tooltip(all_values, "hover")
load("area.rds")
load(area.rds)
shiny::runApp()
shiny::runApp()
attach("area.rds\")
)
attach("area.rds\")
attach("area.rds")
library(googleVis)
library(shiny)
runApp()
runApp()
library(shiny)
library(dplyr)
library(ggvis)
library(reshape)
library(rgdal)
library(rgeos)
library(maptools)
gpclibPermit()
# Define server logic required to summarize and view the selected dataset
shinyServer(function(..., session) {
map<-readShapeSpatial("MDA_Adm1", repair=T)
proj4string(map) <- CRS("+proj=longlat +datum=NAD27")
#   map$NAME_1 <- as.character(a$NAME_1)
#   map$NAME_1[a$NAME_1 == "H??ncesti"] <- "Hincesti"
options(stringsAsFactors = FALSE)
data <- read.csv("report_2014-06-26.csv", sep="\t",header=TRUE)
trim <- function (x) gsub("^\\s+|\\s+$+|\\?", "", x)
replace<-function (x) gsub("unic", "unique", x)
data<-as.data.frame(apply(data,MARGIN=2,FUN=trim))
data<-as.data.frame(apply(data,MARGIN=2,FUN=replace))
data<-data[which(data$Question !="Upload other documents" & data$Question !="Upload photos"),]
data<-data[which(data$Name !="Biblioteca Publica de Drept" & data$Name !="Biblioteca Nationala a Republicii Moldova"),]
data<-data[data$Raion != "Chisinau",]
# users
data$Question[data$Question=="Number of all new unique users to library"]<-"Number of all unique users to library"
pattern <- grep("Number of all unique users to library", data$Question, useBytes = T)
users<-data[pattern,]
users$Answer<-as.numeric(users$Answer)
users<-users%>% group_by(Date) %>% summarise(Answer = sum(Answer,na.rm = TRUE))
users$Date<-as.Date(users$Date)
# Gender
pattern<-agrep("Total number of registered/unic users of each gender",x=data$Question,useBytes=T)
gender<-data[pattern,]
gender$Answer<-as.numeric(gender$Answer)
gender<-gender%>% group_by(Date,Question) %>% summarise(Answer = sum(Answer,na.rm = TRUE))
gender<-cast(gender, Date~Question)
gender$Total<-gender[,2]+gender[,3]
gender$Percent_Female<-gender[,2]/gender[,4]*100
gender$Percent_Male<-gender[,3]/gender[,4]*100
gender<-gender[,c("Date","Percent_Female","Percent_Male")]
gender<-as.data.frame(gender)
gender<-melt(gender,"Date")
gender$Date<-as.Date(gender$Date)
0
)
library(shiny)
library(dplyr)
library(ggvis)
library(reshape)
library(rgdal)
library(rgeos)
library(maptools)
gpclibPermit()
# Define server logic required to summarize and view the selected dataset
shinyServer(function(..., session) {
map<-readShapeSpatial("MDA_Adm1", repair=T)
proj4string(map) <- CRS("+proj=longlat +datum=NAD27")
#   map$NAME_1 <- as.character(a$NAME_1)
#   map$NAME_1[a$NAME_1 == "H??ncesti"] <- "Hincesti"
options(stringsAsFactors = FALSE)
data <- read.csv("report_2014-06-26.csv", sep="\t",header=TRUE)
trim <- function (x) gsub("^\\s+|\\s+$+|\\?", "", x)
replace<-function (x) gsub("unic", "unique", x)
data<-as.data.frame(apply(data,MARGIN=2,FUN=trim))
data<-as.data.frame(apply(data,MARGIN=2,FUN=replace))
data<-data[which(data$Question !="Upload other documents" & data$Question !="Upload photos"),]
data<-data[which(data$Name !="Biblioteca Publica de Drept" & data$Name !="Biblioteca Nationala a Republicii Moldova"),]
data<-data[data$Raion != "Chisinau",]
# users
data$Question[data$Question=="Number of all new unique users to library"]<-"Number of all unique users to library"
pattern <- grep("Number of all unique users to library", data$Question, useBytes = T)
users<-data[pattern,]
users$Answer<-as.numeric(users$Answer)
users<-users%>% group_by(Date) %>% summarise(Answer = sum(Answer,na.rm = TRUE))
users$Date<-as.Date(users$Date)
# Gender
pattern<-agrep("Total number of registered/unic users of each gender",x=data$Question,useBytes=T)
gender<-data[pattern,]
gender$Answer<-as.numeric(gender$Answer)
gender<-gender%>% group_by(Date,Question) %>% summarise(Answer = sum(Answer,na.rm = TRUE))
gender<-cast(gender, Date~Question)
gender$Total<-gender[,2]+gender[,3]
gender$Percent_Female<-gender[,2]/gender[,4]*100
gender$Percent_Male<-gender[,3]/gender[,4]*100
gender<-gender[,c("Date","Percent_Female","Percent_Male")]
gender<-as.data.frame(gender)
gender<-melt(gender,"Date")
gender$Date<-as.Date(gender$Date)
users%>%
ggvis(x=~Date,y=~Answer) %>%
layer_lines() %>%
layer_points() %>%
bind_shiny("u")
gender%>%
ggvis(x=~Date,y=~value,stroke= ~variable) %>%
layer_lines() %>%
layer_points(fill= ~variable) %>%
bind_shiny("g")
})
options(stringsAsFactors = FALSE)
data <- read.csv("report_2014-06-26.csv", sep="\t",header=TRUE)
trim <- function (x) gsub("^\\s+|\\s+$+|\\?", "", x)
replace<-function (x) gsub("unic", "unique", x)
data<-as.data.frame(apply(data,MARGIN=2,FUN=trim))
data<-as.data.frame(apply(data,MARGIN=2,FUN=replace))
data<-data[which(data$Question !="Upload other documents" & data$Question !="Upload photos"),]
data<-data[which(data$Name !="Biblioteca Publica de Drept" & data$Name !="Biblioteca Nationala a Republicii Moldova"),]
data<-data[data$Raion != "Chisinau",]
# users
data$Question[data$Question=="Number of all new unique users to library"]<-"Number of all unique users to library"
pattern <- grep("Number of all unique users to library", data$Question, useBytes = T)
users<-data[pattern,]
users$Answer<-as.numeric(users$Answer)
users<-users%>% group_by(Date) %>% summarise(Answer = sum(Answer,na.rm = TRUE))
users$Date<-as.Date(users$Date)
# Gender
pattern<-agrep("Total number of registered/unic users of each gender",x=data$Question,useBytes=T)
gender<-data[pattern,]
gender$Answer<-as.numeric(gender$Answer)
gender<-gender%>% group_by(Date,Question) %>% summarise(Answer = sum(Answer,na.rm = TRUE))
gender<-cast(gender, Date~Question)
gender$Total<-gender[,2]+gender[,3]
gender$Percent_Female<-gender[,2]/gender[,4]*100
gender$Percent_Male<-gender[,3]/gender[,4]*100
gender<-gender[,c("Date","Percent_Female","Percent_Male")]
gender<-as.data.frame(gender)
gender<-melt(gender,"Date")
gender$Date<-as.Date(gender$Date)
users%>%
ggvis(x=~Date,y=~Answer) %>%
layer_lines() %>%
layer_points() %>%
bind_shiny("u")
runApp()
install.packages("reshape")
runApp()
install.packages("rgeos")
library(shiny)
library(dplyr)
library(ggvis)
library(reshape)
library(rgdal)
library(rgeos)
library(maptools)
gpclibPermit()
runApp()
all_values <- function(x) {
if(is.null(x)) return(NULL)
paste0(names(x), ": ", format(x), collapse = "<br />")
}
gender%>%
ggvis(x=~Date,y=~value,stroke= ~variable) %>%
layer_lines() %>%
layer_points() %>%
add_tooltip(all_values, "hover")
all_values <- function(x) {
if(is.null(x)) return(NULL)
paste0(names(x), ": ", format(x), collapse = "<br />")
}
gender%>%
ggvis(x=~Date,y=~value,stroke= ~variable) %>%
layer_lines() %>%
layer_points() %>%
add_tooltip(all_values, "hover")
all_values <- function(x) {
if(is.null(x)) return(NULL)
paste0(names(x), ": ", format(x), collapse = "<br />")
}
gender%>%
ggvis(x=~Date,y=~value,stroke= ~variable) %>%
layer_lines() %>%
layer_points() %>%
add_tooltip(all_values, "hover")
View(gender)
gender%>%
ggvis(x=~Date,y=~value,stroke= ~Question) %>%
layer_lines() %>%
layer_points() %>%
add_tooltip(all_values, "hover")
View(gender)
gender%>%
ggvis(x=~Date,y=~Answer,stroke= ~Question) %>%
layer_lines() %>%
layer_points() %>%
add_tooltip(all_values, "hover")
gender%>%
ggvis(x=~Date,y=~Answer,stroke= ~Question) %>%
layer_lines() %>%
layer_points() %>%
axis_pros=ps(labels=NULL)%>%
add_tooltip(all_values, "hover")
gender%>%
ggvis(x=~Date,y=~Answer,stroke= ~Question) %>%
layer_lines() %>%
layer_points() %>%
axis_pros(labels=NULL)%>%
add_tooltip(all_values, "hover")
gender%>%
ggvis(x=~Date,y=~Answer,stroke= ~Question) %>%
layer_lines() %>%
layer_points() %>%
axis_props(labels=NULL)%>%
add_tooltip(all_values, "hover")
gender%>%
ggvis(x=~Date,y=~Answer,stroke= ~Question) %>%
layer_lines() %>%
layer_points() %>%
hide_axis(labels=NULL)%>%
add_tooltip(all_values, "hover")
gender%>%
ggvis(x=~Date,y=~Answer,stroke= ~Question) %>%
layer_lines() %>%
layer_points() %>%
properties = axis_props(
ticks = list(stroke = "red"),
majorTicks = list(strokeWidth = 2),
grid = list(stroke = "red"),
labels = list(
fill = "steelblue",
angle = 50,
fontSize = 14,
align = "left",
baseline = "middle",
dx = 3
)%>%
add_tooltip(all_values, "hover")
)
gender%>%
ggvis(x=~Date,y=~Answer,stroke= ~Question) %>%
layer_lines() %>%
layer_points() %>%
add_axis("x", title = "Weight", ticks = 40,
properties = axis_props(
ticks = list(stroke = "red"),
majorTicks = list(strokeWidth = 2),
grid = list(stroke = "red"),
labels = list(
fill = "steelblue",
angle = 50,
fontSize = 14,
align = "left",
baseline = "middle",
dx = 3
),
title = list(fontSize = 16),
axis = list(stroke = "#333", strokeWidth = 1.5)
)
)%>%
add_tooltip(all_values, "hover")
gender%>%
ggvis(x=~Date,y=~Answer,stroke= ~Question) %>%
layer_lines() %>%
layer_points() %>%
add_axis("x", title = NULL, ticks = 40,
properties = axis_props(
ticks = list(stroke = "red"),
majorTicks = list(strokeWidth = 2),
grid = list(stroke = "red"),
labels = list(
fill = "steelblue",
angle = 50,
fontSize = 14,
align = "left",
baseline = "middle",
dx = 3
),
title = list(fontSize = 16),
axis = list(stroke = "#333", strokeWidth = 1.5)
)
)%>%
add_tooltip(all_values, "hover")
gender%>%
ggvis(x=~Date,y=~Answer,stroke= ~Question) %>%
layer_lines() %>%
layer_points() %>%
add_axis("x", title = "")%>%
add_tooltip(all_values, "hover")
gender%>%
ggvis(x=~Date,y=~Answer,stroke= ~Question) %>%
layer_lines() %>%
layer_points() %>%
add_axis("x", title = "")%>%
add_axis("y", title = "")%>%
add_tooltip(all_values, "hover")
gender%>%
ggvis(x=~Date,y=~Answer,stroke= ~Question) %>%
layer_lines() %>%
layer_points(stroke=~Question) %>%
add_axis("x", title = "")%>%
add_axis("y", title = "")%>%
add_tooltip(all_values, "hover")
runApp()
runApp()
runApp()
runApp()
runApp()
View(data)
runApp()
str(default_options()
)
sidebarBottomPage(sidebarBottomPanel(), mainTopPanel())
sidebarBottomPage(sidebarBottomPanel(), mainTopPanel())
p <- mtcars %>% ggvis(~wt, ~mpg, fill = ~hp) %>% layer_points()
p %>% scale_numeric("x", domain = c(0, 3), clamp = TRUE, expand = 0,
nice = FALSE)
users%>%
ggvis(x=~Date,y=~Answer) %>%
layer_lines() %>%
layer_points() %>%
add_axis("x", title = "")%>%
add_axis("y", title = "")%>%
scale_numeric("y", domain = c(0, 15000)
)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
map<-readShapeSpatial("MDA_Adm1", repair=T)
proj4string(map) <- CRS("+proj=longlat +datum=NAD27")
shiny::runApp()
library(googleVis)
library(shiny)
shiny::runApp()
library(ggvis)
shiny::runApp()
library(shiny)
library(dplyr)
library(ggvis)
library(reshape)
library(rgdal)
library(rgeos)
library(maptools)
gpclibPermit()
map<-readShapeSpatial("MDA_Adm1", repair=T)
proj4string(map) <- CRS("+proj=longlat +datum=NAD27")
map<- fortify(map, region="NAME_1")
